\begin{figure}[H]
    \centering
    \pgfplotstableread[
        col sep=comma,
        ignore chars={\"}
    ]{../results/kaq1.csv}\kaqone
    \begin{tikzpicture}
        \begin{axis}[
            width=\textwidth,
            height=0.6\textwidth,
            xlabel={Month},
            ylabel={Monthly DAU},
            xmin=1,
            xmax=24,
            ymin=0,
            ymax=2000,
            xtick={1,...,24},
            xticklabels={
                Jan 2024,Feb 2024,Mar 2024,Apr 2024,May 2024,Jun 2024,
                Jul 2024,Aug 2024,Sep 2024,Oct 2024,Nov 2024,Dec 2024,
                Jan 2025,Feb 2025,Mar 2025,Apr 2025,May 2025,Jun 2025,
                Jul 2025,Aug 2025,Sep 2025,Oct 2025,Nov 2025,Dec 2025
            },
            xticklabel style={rotate=45, anchor=east},
            tick label style={font=\small},
            legend style={at={(0.02,0.98)}, anchor=north west, nodes={scale=0.9, transform shape}},
            legend columns=2,
            grid=both,
            major grid style={dashed, gray!35},
            minor grid style={dotted, gray!20},
            enlargelimits=0.02,
            unbounded coords=discard
        ]
            \addplot+[semithick, mark=*, mark size=2pt] table[
                x expr=\coordindex+1,
                y=dau,
                row predicate/.code={
                    \pgfplotstablegetelem{\pgfplotstablerow}{year}\of{\kaqone}%
                    \edef\tempYear{\pgfplotsretval}%
                    \ifnum\pdfstrcmp{\tempYear}{2024}=0\else
                        \ifnum\pdfstrcmp{\tempYear}{2025}=0\else\pgfplotstableuserowfalse\fi
                    \fi
                    \pgfplotstablegetelem{\pgfplotstablerow}{subscription_tier}\of{\kaqone}%
                    \edef\tempTier{\pgfplotsretval}%
                    \ifnum\pdfstrcmp{\tempTier}{Free}=0\else\pgfplotstableuserowfalse\fi
                }
            ] {\kaqone};
            \addplot+[semithick, mark=square*, mark size=2pt] table[
                x expr=\coordindex+1,
                y=dau,
                row predicate/.code={
                    \pgfplotstablegetelem{\pgfplotstablerow}{year}\of{\kaqone}%
                    \edef\tempYear{\pgfplotsretval}%
                    \ifnum\pdfstrcmp{\tempYear}{2024}=0\else
                        \ifnum\pdfstrcmp{\tempYear}{2025}=0\else\pgfplotstableuserowfalse\fi
                    \fi
                    \pgfplotstablegetelem{\pgfplotstablerow}{subscription_tier}\of{\kaqone}%
                    \edef\tempTier{\pgfplotsretval}%
                    \ifnum\pdfstrcmp{\tempTier}{Plus}=0\else\pgfplotstableuserowfalse\fi
                }
            ] {\kaqone};
            \addplot+[semithick, mark=triangle*, mark size=3pt] table[
                x expr=\coordindex+1,
                y=dau,
                row predicate/.code={
                    \pgfplotstablegetelem{\pgfplotstablerow}{year}\of{\kaqone}%
                    \edef\tempYear{\pgfplotsretval}%
                    \ifnum\pdfstrcmp{\tempYear}{2024}=0\else
                        \ifnum\pdfstrcmp{\tempYear}{2025}=0\else\pgfplotstableuserowfalse\fi
                    \fi
                    \pgfplotstablegetelem{\pgfplotstablerow}{subscription_tier}\of{\kaqone}%
                    \edef\tempTier{\pgfplotsretval}%
                    \ifnum\pdfstrcmp{\tempTier}{Business}=0\else\pgfplotstableuserowfalse\fi
                }
            ] {\kaqone};
            \addplot+[semithick, mark=diamond*, mark size=2.5pt] table[
                x expr=\coordindex+1,
                y=dau,
                row predicate/.code={
                    \pgfplotstablegetelem{\pgfplotstablerow}{year}\of{\kaqone}%
                    \edef\tempYear{\pgfplotsretval}%
                    \ifnum\pdfstrcmp{\tempYear}{2024}=0\else
                        \ifnum\pdfstrcmp{\tempYear}{2025}=0\else\pgfplotstableuserowfalse\fi
                    \fi
                    \pgfplotstablegetelem{\pgfplotstablerow}{subscription_tier}\of{\kaqone}%
                    \edef\tempTier{\pgfplotsretval}%
                    \ifnum\pdfstrcmp{\tempTier}{Enterprise}=0\else\pgfplotstableuserowfalse\fi
                }
            ] {\kaqone};
            \addplot+[semithick, mark=star, mark size=2.8pt] table[
                x expr=\coordindex+1,
                y=dau,
                row predicate/.code={
                    \pgfplotstablegetelem{\pgfplotstablerow}{year}\of{\kaqone}%
                    \edef\tempYear{\pgfplotsretval}%
                    \ifnum\pdfstrcmp{\tempYear}{2024}=0\else
                        \ifnum\pdfstrcmp{\tempYear}{2025}=0\else\pgfplotstableuserowfalse\fi
                    \fi
                    \pgfplotstablegetelem{\pgfplotstablerow}{subscription_tier}\of{\kaqone}%
                    \edef\tempTier{\pgfplotsretval}%
                    \ifnum\pdfstrcmp{\tempTier}{NULL}=0\else\pgfplotstableuserowfalse\fi
                }
            ] {\kaqone};
            \legend{Free, Plus, Business, Enterprise, Combined}
        \end{axis}
    \end{tikzpicture}
    \caption{Monthly DAU by subscription tier for Jan 2024--Dec 2025.}
    \label{fig:kaq1-dau}
\end{figure}
